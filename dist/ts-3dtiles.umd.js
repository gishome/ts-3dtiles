!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).ts3dtils={})}(this,function(t){"use strict";var e;(e=s=s||{}).TWO="2.0",e.ONE="1.0";var s,r=s;class i{constructor(){this.version=r.TWO,this.extensions=new Set,this.validate=()=>!0}}(s=a=a||{}).OPAQUE="OPAQUE",s.MASK="MASK",s.BLEND="BLEND";var a,n=a;(a=c=c||{})[a.POINTS=0]="POINTS",a[a.LINES=1]="LINES",a[a.LINE_LOOP=2]="LINE_LOOP",a[a.LINE_STRIP=3]="LINE_STRIP",a[a.TRIANGLES=4]="TRIANGLES",a[a.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",a[a.TRIANGLE_FAN=6]="TRIANGLE_FAN";var h=c;class o{constructor(t){this.position=t.position,this.st1=t.st1,this.normal=t.normal}validate(){return Object.values(this).every(t=>t<0)}}(c=l=l||{}).SCALAR="SCALAR",c.VEC2="VEC2",c.VEC3="VEC3",c.VEC4="VEC4",c.MAT2="MAT2",c.MAT3="MAT3",c.MAT4="MAT4";var l,c=l;(l=d=d||{})[l.BYTE=5120]="BYTE",l[l.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",l[l.SHORT=5122]="SHORT",l[l.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",l[l.UNSIGNED_INT=5125]="UNSIGNED_INT",l[l.FLOAT=5126]="FLOAT";var u=d;(d=f=f||{})[d.NEAREST=9728]="NEAREST",d[d.LINEAR=9729]="LINEAR",d[d.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",d[d.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",d[d.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",d[d.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR";var d=f;(f=T=T||{})[f.REPEAT=10497]="REPEAT",f[f.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",f[f.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT";var f=T;(T=N=N||{}).JPG="image/jpg",T.JPEG="image/jpeg",T.PNG="image/png",T.WEBP="image/webp";var T=N;class g{constructor(t,e){this.index=t,this.texCoord=e}validate(){return this.index<0||this.texCoord<0}}class b{get isRequire(){return!1}validate(){return!0}}class y{}class L{validate(){return!0}}class v extends L{constructor(){super()}}function p(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function m(t,e){return t(e={exports:{}},e.exports),e.exports}function E(t="utf-8"){if("utf-8"!==t)throw new RangeError(`Failed to construct 'TextEncoder': The encoding label provided ('${t}') is invalid.`)}function B(t="utf-8",e={fatal:!1}){if("utf-8"!==t)throw new RangeError(`Failed to construct 'TextDecoder': The encoding label provided ('${t}') is invalid.`);if(e.fatal)throw new Error("Failed to construct 'TextDecoder': the 'fatal' option is unsupported.")}(N="undefined"!=typeof window?window:"undefined"!=typeof self?self:void 0).TextEncoder&&N.TextDecoder||(Object.defineProperty(E.prototype,"encoding",{value:"utf-8"}),E.prototype.encode=function(e,t={stream:!1}){if(t.stream)throw new Error("Failed to encode: the 'stream' option is unsupported.");let s=0;var r,i=e.length;let a=0,n=Math.max(32,i+(i>>1)+7),h=new Uint8Array(n>>3<<3);for(;s<i;){let t=e.charCodeAt(s++);if(55296<=t&&t<=56319)if(s<i&&(56320==(64512&(r=e.charCodeAt(s)))&&(++s,t=((1023&t)<<10)+(1023&r)+65536)),55296<=t&&t<=56319)continue;if(a+4>h.length){n+=8,n*=1+s/e.length*2,n=n>>3<<3;const o=new Uint8Array(n);o.set(h),h=o}if(0!=(4294967168&t)){if(0==(4294965248&t))h[a++]=t>>6&31|192;else if(0==(4294901760&t))h[a++]=t>>12&15|224,h[a++]=t>>6&63|128;else{if(0!=(4292870144&t))continue;h[a++]=t>>18&7|240,h[a++]=t>>12&63|128,h[a++]=t>>6&63|128}h[a++]=63&t|128}else h[a++]=t}return h.slice(0,a)},Object.defineProperty(B.prototype,"encoding",{value:"utf-8"}),Object.defineProperty(B.prototype,"fatal",{value:!1}),Object.defineProperty(B.prototype,"ignoreBOM",{value:!1}),B.prototype.decode=function(t,e={stream:!1}){if(e.stream)throw new Error("Failed to decode: the 'stream' option is unsupported.");var s=new Uint8Array(t);let r=0;var i=s.length;const a=[];for(;r<i;){var n=s[r++];if(0===n)break;if(0==(128&n))a.push(n);else if(192==(224&n)){var h=63&s[r++];a.push((31&n)<<6|h)}else if(224==(240&n)){var o=63&s[r++],h=63&s[r++];a.push((31&n)<<12|o<<6|h)}else if(240==(248&n)){let t=(7&n)<<18|(63&s[r++])<<12|(63&s[r++])<<6|63&s[r++];65535<t&&(t-=65536,a.push(t>>>10&1023|55296),t=56320|1023&t),a.push(t)}}return String.fromCharCode.apply(null,a)},N.TextEncoder=E,N.TextDecoder=B);var S=m(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.encode=e.decode=void 0;const s=new TextDecoder("utf-8");e.decode=function(t){return s.decode(t)};const r=new TextEncoder;e.encode=function(t){return r.encode(t)}});p(S),S.encode,S.decode;var N=m(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.IOBuffer=void 0;e.IOBuffer=class a{constructor(t=8192,e={}){let s=!1;"number"==typeof t?t=new ArrayBuffer(t):(s=!0,this.lastWrittenByte=t.byteLength);var r=e.offset?e.offset>>>0:0,e=t.byteLength-r;let i=r;(ArrayBuffer.isView(t)||t instanceof a)&&(t.byteLength!==t.buffer.byteLength&&(i=t.byteOffset+r),t=t.buffer),s?this.lastWrittenByte=e:this.lastWrittenByte=0,this.buffer=t,this.length=e,this.byteLength=e,this.byteOffset=i,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,i,e),this._mark=0,this._marks=[]}available(t=1){return this.offset+t<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(t=1){return this.offset+=t,this}seek(t){return this.offset=t,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){var t=this._marks.pop();if(void 0===t)throw new Error("Mark stack empty");return this.seek(t),this}rewind(){return this.offset=0,this}ensureAvailable(t=1){if(!this.available(t)){t=2*(this.offset+t);const e=new Uint8Array(t);e.set(new Uint8Array(this.buffer)),this.buffer=e.buffer,this.length=this.byteLength=t,this._data=new DataView(this.buffer)}return this}readBoolean(){return 0!==this.readUint8()}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(e=1){const s=new Uint8Array(e);for(let t=0;t<e;t++)s[t]=this.readByte();return s}readInt16(){var t=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,t}readUint16(){var t=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,t}readInt32(){var t=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,t}readUint32(){var t=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat32(){var t=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat64(){var t=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t}readChar(){return String.fromCharCode(this.readInt8())}readChars(e=1){let s="";for(let t=0;t<e;t++)s+=this.readChar();return s}readUtf8(t=1){return S.decode(this.readBytes(t))}writeBoolean(t){return this.writeUint8(t?255:0),this}writeInt8(t){return this.ensureAvailable(1),this._data.setInt8(this.offset++,t),this._updateLastWrittenByte(),this}writeUint8(t){return this.ensureAvailable(1),this._data.setUint8(this.offset++,t),this._updateLastWrittenByte(),this}writeByte(t){return this.writeUint8(t)}writeBytes(e){this.ensureAvailable(e.length);for(let t=0;t<e.length;t++)this._data.setUint8(this.offset++,e[t]);return this._updateLastWrittenByte(),this}writeInt16(t){return this.ensureAvailable(2),this._data.setInt16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(t){return this.ensureAvailable(2),this._data.setUint16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(t){return this.ensureAvailable(4),this._data.setInt32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(t){return this.ensureAvailable(4),this._data.setUint32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(t){return this.ensureAvailable(4),this._data.setFloat32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(t){return this.ensureAvailable(8),this._data.setFloat64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(t){return this.writeUint8(t.charCodeAt(0))}writeChars(e){for(let t=0;t<e.length;t++)this.writeUint8(e.charCodeAt(t));return this}writeUtf8(t){return this.writeBytes(S.encode(t))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}});p(N);var _=N.IOBuffer;(N=O=O||{}).B3dm="b3dm",N.I3dm="i3dm",N.Pnts="pnts",N.Vctr="vctr";var O,A=O;class w{validate(){return!1}}class I extends w{constructor(){super()}static createFromJSON(t,e){const s=new I;return s._json=t,s._binary=e,s.featureTableType=A.B3dm,t=s,e=t._json,t.batchLength=e.BATCH_LENGTH,t.rtcCenter=e.RTC_CENTER,void 0!==e.extensions&&(t.extensions=new Set),t.extras=e.extras,s}validate(){return void 0!==this.batchLength}}class x{constructor(){this.variables=new Map}static createFromJSON(t,e){const s=new x;return s._json=t,s._binary=e,function(t){for(const e of Object.keys(t._json))t.variables.set(e,t._json[e])}(s),s}validate(){return!0}get variableNames(){return Object.keys(this._json)}get variableCounts(){return this.variableNames.length}getVariable(t){if(this.variables.has(t))return this.variables.get(t);throw new Error(`[BatchTable getVariable()] 没有这个值：${t}。`)}}class R extends L{constructor(){super()}validate(){return 0===this.gltfFormat||1===this.gltfFormat}}class F extends w{constructor(){super()}static createFromJSON(t,e){const s=new F;return s._json=t,s._binary=e,s.featureTableType=A.I3dm,t=s,e=t._json,t.position=e.POSITION,t.positionQuantized=e.POSITION_QUANTIZED,t.normalUp=e.NORMAL_UP,t.normalRight=e.NORMAL_RIGHT,t.normalUpOct32p=e.NORMAL_UP_OCT32P,t.normalRightOct32p=e.NORMAL_RIGHT_OCT32P,t.scale=e.SCALE,t.scaleNonUniform=e.SCALE_NON_UNIFORM,t.instancesLength=e.INSTANCES_LENGTH,t.rtcCenter=e.RTC_CENTER,t.quantizedVolumeOffset=e.QUANTIZED_VOLUME_OFFSET,t.quantizedVolumeScale=e.QUANTIZED_VOLUME_SCALE,void 0!==e.extensions&&(t.extensions=new Set),t.extras=e.extras,s}validate(){return(void 0!==(t=this).position||void 0!==t.positionQuantized)&&((void 0===t.position||void 0===t.positionQuantized)&&((void 0===t.positionQuantized||void 0!==t.quantizedVolumeOffset&&void 0!==t.quantizedVolumeScale)&&(!(void 0===t.normalUp&&void 0!==t.normalRight||void 0===t.normalRight&&void 0!==t.normalUp)&&!(void 0===t.normalUpOct32p&&void 0!==t.normalRightOct32p||void 0===t.normalRightOct32p&&void 0!==t.normalUpOct32p))));var t}}class U extends L{constructor(){super()}}class G extends w{constructor(){super()}static createFromJSON(t,e){const s=new G;return s._json=t,s._binary=e,s.featureTableType=A.Pnts,t=s,e=t._json,t.position=e.POSITION,t.positionQuantized=e.POSITION_QUANTIZED,t.rgba=e.RGBA,t.rgb=e.RGB,t.rgb565=e.RGB565,t.normal=e.NORMAL,t.normalOct16p=e.NORMAL_OCT16P,t.batchId=e.BATCH_ID,t.pointsLength=e.POINTS_LENGTH,t.quantizedVolumeOffset=e.QUANTIZED_VOLUME_OFFSET,t.quantizedVolumeScale=e.QUANTIZED_VOLUME_SCALE,t.constantRgba=e.CONSTANT_RGBA,void 0!==e.extensions&&(t.extensions=new Set),t.extras=e.extras,s}validate(){return(void 0!==(t=this).position||void 0!==t.positionQuantized)&&((void 0===t.batchId||void 0!==t.batchLength)&&(void 0===t.positionQuantized||void 0!==t.quantizedVolumeOffset&&void 0!==t.quantizedVolumeScale));var t}}(O=P=P||{}).ADD="add",O.REPLACE="replace";var P=P;t.Asset=class{validate(){return!0}},t.B3dm=class{constructor(t,e=!1){this.header=new v,function(t,e){const s=new _(e);if(r=t.header,(e=s).rewind(),r.magic=e.readChars(4),r.version=e.readUint32(),r.byteLength=e.readUint32(),r.featureTableJSONByteLength=e.readUint32(),r.featureTableBinaryByteLength=e.readUint32(),r.batchTableJSONByteLength=e.readUint32(),r.batchTableBinaryByteLength=e.readUint32(),t.byteLength%8!=0)throw new Error("[B3dm 实例化错误] byteLength 未 8 字节对齐。");s.rewind(),s.skip(28);var r=JSON.parse(s.readChars(t.featureTableJSONByteLength)),e=s.readBytes(t.featureTableBinaryByteLength);t.featureTable=I.createFromJSON(r,e),0!==t.batchTableJSONByteLength&&(r=JSON.parse(s.readChars(t.batchTableJSONByteLength)),e=s.readBytes(t.batchTableBinaryByteLength),t.batchTable=x.createFromJSON(r,e))}(this,t),!0===e&&(this.buffer=t)}validate(){return!0}get magic(){return this.header.magic}get byteLength(){return this.header.byteLength}get version(){return this.header.version}get featureTableJSONByteLength(){return this.header.featureTableJSONByteLength}get featureTableBinaryByteLength(){return this.header.featureTableBinaryByteLength}get batchTableJSONByteLength(){return this.header.batchTableJSONByteLength}get batchTableBinaryByteLength(){return this.header.batchTableBinaryByteLength}get sizeWithoutGLB(){return 28+this.featureTableJSONByteLength+this.featureTableBinaryByteLength+this.batchTableJSONByteLength+this.batchTableBinaryByteLength}},t.B3dmHeader=v,t.BatchTable=x,t.Cmpt=class{},t.ExtBatchtableHierarchy=class extends y{constructor(){super(...arguments),this.name="3DTILES_batch_table_hierarchy"}load(){}},t.ExtContentGLTF=class extends y{constructor(){super(...arguments),this.name="3DTILES_content_gltf"}},t.ExtDraco=class extends b{constructor(){super(...arguments),this.name="KHR_draco_mesh_compression"}get isRequire(){return!0}validate(){return Number.isInteger(this.bufferView)}},t.ExtImplicitTiling=class extends y{constructor(){super(...arguments),this.name="3DTILES_implicit_tiling"}},t.ExtLayers=class extends y{constructor(){super(...arguments),this.name="3DTILES_layers"}},t.ExtMetadata=class extends y{constructor(){super(...arguments),this.name="3DTILES_metadata"}},t.ExtMultipleContent=class extends y{constructor(){super(...arguments),this.name="3DTILES_multiple_contents"}},t.ExtPbrSpecularGlossiness=class extends b{constructor(){super(...arguments),this.name="KHR_materials_pbrSpecularGlossiness"}get isRequire(){return!0}validate(){return!0}},t.ExtPntsDraco=class extends y{constructor(){super(...arguments),this.name="3DTILES_draco_point_compression"}},t.FeatureTable=w,t.GLTFAccessor=class{constructor(t){this.extensions=new Set,this.componentType=t.componentType,this.count=t.count,this.type=t.type}validate(){return void 0!==this.byteOffset&&void 0!==this.bufferView}},t.GLTFAccessorSparse=class{validate(){return this.values.validate()&&this.indices.validate()}},t.GLTFAccessorSparseIndices=class{constructor(){this.extensions=new Set}validate(){return this.componentType===u.UNSIGNED_BYTE||this.componentType===u.UNSIGNED_INT||this.componentType===u.UNSIGNED_SHORT}},t.GLTFAccessorSparseValues=class{constructor(){this.extensions=new Set}validate(){return!(this.byteOffset<0)}},t.GLTFAlphaMode=n,t.GLTFAnimation=class{constructor(){this.extensions=new Set}validate(){return!(this.channels.length<1||this.samplers.length<1)}},t.GLTFAnimationChannel=class{constructor(){this.extensions=new Set,this.validate=()=>this.target.validate()}},t.GLTFAnimationChannelTarget=class{constructor(){this.extensions=new Set,this.validate=()=>!0}},t.GLTFAnimationSampler=class{},t.GLTFAsset=i,t.GLTFAttributeType=c,t.GLTFBuffer=class{constructor(){this.byteLength=0,this.extensions=new Set}validate(){return!(this.byteLength<0)}},t.GLTFBufferView=class{constructor(){this.buffer=0,this.byteLength=0,this.byteOffset=0,this.extensions=new Set}validate(){return!(this.buffer<0)&&(!(this.byteLength<0)&&!(this.byteOffset<0))}},t.GLTFCamera=class{constructor(t){this.extensions=new Set,this.orthographic=t.orthographic,this.perspective=t.perspective,this.type=t.type,this.name=t.name}validate(){return void 0===this.orthographic||void 0===this.perspective}},t.GLTFComponentType=u,t.GLTFDocument=class{constructor(){this.asset=new i,this.scene=0,this.buffers=[],this.bufferViews=[],this.accessors=[],this.scenes=[],this.nodes=[],this.meshes=[],this.materials=[],this.textures=[],this.images=[],this.samplers=[]}},t.GLTFExtensionBase=b,t.GLTFFilter=d,t.GLTFImage=class{constructor(){this.extensions=new Set}validate(){return(void 0===this.uri||void 0===this.bufferView)&&(void 0===this.bufferView||void 0!==this.mimeType)}},t.GLTFMaterial=class{constructor(){this.extensions=new Set}validate(){return!1!==this.pbrMetallicRoughness.validate()&&(!1!==this.normalTexture.validate()&&(!1!==this.occlusionTexture.validate()&&((this.alphaMode!==n.MASK||void 0!==this.alphaCutoff)&&3===this.emissiveFactor.length)))}},t.GLTFMesh=class{constructor(){this.primitives=[],this.extensions=new Set}validate(){let t=!1;return this.primitives.every(t=>t.validate())&&(t=!0),t}},t.GLTFNode=class{constructor(t){this.children=[],this.extensions=new Set,this.mesh=t.mesh,this.camera=t.camera,this.scale=t.scale,this.skin=t.skin,this.matrix=t.matrix,this.translation=t.translation,this.rotation=t.rotation,this.name=t.name,this.weights=t.weights}validateTransforms(){let t=!0;return void 0!==this.matrix&&(void 0===this.rotation&&void 0===this.scale&&void 0===this.translation||(t=!1)),16!==this.matrix.length&&(t=!1),3!==this.scale.length&&(t=!1),3!==this.translation.length&&(t=!1),t=4===this.rotation.length&&this.rotation.every(t=>1<t||t<-1),t}validate(){return!this.validateTransforms()&&(!(this.weights.length<1)&&((void 0===this.weights||void 0!==this.mesh)&&((void 0===this.skin||void 0!==this.mesh)&&!(this.children.length<1))))}},t.GLTFNormalTextureInfo=class extends g{constructor(t,e,s){super(t,e),this.extensions=new Set,this.scale=s}},t.GLTFOcclusionTextureInfo=class extends g{constructor(t,e,s){super(t,e),this.extensions=new Set,this.strength=s}validate(){return 1<this.strength||this.strength<0}},t.GLTFOrthographicCamera=class{constructor(t){this.xmag=t.xmag,this.ymag=t.ymag,this.zfar=t.zfar,this.znear=t.znear}},t.GLTFPbr=class{constructor(){this.extensions=new Set}validate(){return 4===this.baseColorFactor.length&&!this.baseColorFactor.every(t=>t<0||1<t)&&(!(1<this.roughnessFactor||this.roughnessFactor<0)&&(!(1<this.metallicFactor||this.metallicFactor<0)&&(!1!==this.baseColorTexture.validate()&&!1!==this.metallicRoughnessTexture.validate())))}},t.GLTFPerspectiveCamera=class{constructor(t){this.yfov=t.yfov,this.znear=t.znear,this.zfar=t.zfar,this.aspectRatio=t.aspectRatio}validate(){return!1}},t.GLTFPrimitive=class{constructor(t){this.extensions=new Set,this.attribute=new o({position:t.attribute.position,st1:t.attribute.st1,normal:t.attribute.normal}),this.indices=t.indices,this.material=t.material,t.mode!==h.TRIANGLES&&(this.mode=t.mode)}validate(){return!1!==this.attribute.validate()&&(!(this.indices<0)&&!(this.material<0))}},t.GLTFPrimitiveAttribute=o,t.GLTFPrimitiveMode=h,t.GLTFReadAction=class{constructor(){}read(t){t()}},t.GLTFSampler=class{constructor(){this.extensions=new Set,this.validate=()=>!0}},t.GLTFScene=class{constructor(){this.nodes=[],this.extensions=new Set}validate(){return this.nodes.length<1}},t.GLTFSkin=class{constructor(){this.extensions=new Set}validate(){return!(this.joints.length<1)}},t.GLTFTexture=class{constructor(){this.extensions=new Set,this.validate=()=>!0}},t.GLTFTextureInfo=g,t.GLTFVersion=r,t.GLTFWrapMode=f,t.GLTFWriteAction=class{constructor(){this.doc=void 0}setDocument(t){this.doc=t}write(t){return console.log(t),this.doc}},t.I3dm=class{constructor(t,e=!1){this.header=new R,function(t,e){const s=new _(e);if(r=t.header,(e=s).rewind(),r.magic=e.readChars(4),r.version=e.readUint32(),r.byteLength=e.readUint32(),r.featureTableJSONByteLength=e.readUint32(),r.featureTableBinaryByteLength=e.readUint32(),r.batchTableJSONByteLength=e.readUint32(),r.batchTableBinaryByteLength=e.readUint32(),r.gltfFormat=e.readUint32(),t.byteLength%8!=0)throw new Error("[I3dm 实例化错误] byteLength 未 8 字节对齐。");s.rewind(),s.skip(32);var r=JSON.parse(s.readChars(t.featureTableJSONByteLength)),e=s.readBytes(t.featureTableBinaryByteLength);t.featureTable=F.createFromJSON(r,e),0!==t.batchTableJSONByteLength&&(r=JSON.parse(s.readChars(t.batchTableJSONByteLength)),e=s.readBytes(t.batchTableBinaryByteLength),t.batchTable=x.createFromJSON(r,e))}(this,t),!0===e&&(this.buffer=t)}validate(){return!0}get magic(){return this.header.magic}get byteLength(){return this.header.byteLength}get version(){return this.header.version}get featureTableJSONByteLength(){return this.header.featureTableJSONByteLength}get featureTableBinaryByteLength(){return this.header.featureTableBinaryByteLength}get batchTableJSONByteLength(){return this.header.batchTableJSONByteLength}get batchTableBinaryByteLength(){return this.header.batchTableBinaryByteLength}get gltfFormat(){return this.header.gltfFormat}get sizeWithoutExternalData(){return 32+this.featureTableJSONByteLength+this.featureTableBinaryByteLength+this.batchTableJSONByteLength+this.batchTableBinaryByteLength}},t.I3dmHeader=R,t.MIME=T,t.Pnts=class{constructor(t,e=!1){this.header=new U,function(t,e){const s=new _(e);if(r=t.header,(e=s).rewind(),r.magic=e.readChars(4),r.version=e.readUint32(),r.byteLength=e.readUint32(),r.featureTableJSONByteLength=e.readUint32(),r.featureTableBinaryByteLength=e.readUint32(),r.batchTableJSONByteLength=e.readUint32(),r.batchTableBinaryByteLength=e.readUint32(),t.byteLength%8!=0)throw new Error("[Pnts 实例化错误] byteLength 未 8 字节对齐。");s.rewind(),s.skip(28);var r=JSON.parse(s.readChars(t.featureTableJSONByteLength)),e=s.readBytes(t.featureTableBinaryByteLength);t.featureTable=G.createFromJSON(r,e),0!==t.batchTableJSONByteLength&&(r=JSON.parse(s.readChars(t.batchTableJSONByteLength)),e=s.readBytes(t.batchTableBinaryByteLength),t.batchTable=x.createFromJSON(r,e))}(this,t),!0===e&&(this.buffer=t)}validate(){return!0}get magic(){return this.header.magic}get byteLength(){return this.header.byteLength}get version(){return this.header.version}get featureTableJSONByteLength(){return this.header.featureTableJSONByteLength}get featureTableBinaryByteLength(){return this.header.featureTableBinaryByteLength}get batchTableJSONByteLength(){return this.header.batchTableJSONByteLength}get batchTableBinaryByteLength(){return this.header.batchTableBinaryByteLength}get sizeWithoutGLB(){return 28+this.featureTableJSONByteLength+this.featureTableBinaryByteLength+this.batchTableJSONByteLength+this.batchTableBinaryByteLength}},t.PntsHeader=U,t.Property=class{},t.Tile=class{constructor(){this.transform=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this.extensions=new Set}validate(){return!0}toJson(){if(!this.validate())throw new Error("[Tile toJson()] 验证此对象失败！");void 0!==this.transform&&Object.defineProperty({},"transform",{value:this.transform})}},t.TileBoundingVolume=class{validate(){return(void 0===this.box?1:0)+(void 0===this.region?1:0)+(void 0===this.sphere?1:0)==2&&(12==this.box.length&&(6==this.region.length&&4==this.sphere.length))}},t.TileContent=class{constructor(){this.extensions=new Set}get url(){return this.uri}validate(){return!0}},t.TileHeaderBase=L,t.TileRefine=P,t.Tileset=class{constructor(t){this.extensions=new Set,this.extensionsUsed=[],this.extensionsRequired=[],this.root=t.root,this.geometricError=t.geometricError,this.uri=t.uri}get url(){return this.uri}set url(t){this.uri=t}},Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=ts-3dtiles.umd.js.map
