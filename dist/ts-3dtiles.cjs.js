"use strict";var GLTFVersion;Object.defineProperty(exports,"__esModule",{value:!0}),function(e){e.TWO="2.0",e.ONE="1.0"}(GLTFVersion=GLTFVersion||{});var GLTFAlphaMode,GLTFVersion$1=GLTFVersion;class GLTFAsset{constructor(){this.version=GLTFVersion$1.TWO,this.extensions=new Set,this.validate=()=>!0}}class GLTFAccessor{constructor(e){this.extensions=new Set,this.componentType=e.componentType,this.count=e.count,this.type=e.type}validate(){return void 0!==this.byteOffset&&void 0!==this.bufferView}}class GLTFBuffer{constructor(){this.byteLength=0,this.extensions=new Set}validate(){return!(this.byteLength<0)}}class GLTFBufferView{constructor(){this.buffer=0,this.byteLength=0,this.byteOffset=0,this.extensions=new Set}validate(){return!(this.buffer<0)&&(!(this.byteLength<0)&&!(this.byteOffset<0))}}class GLTFScene{constructor(){this.nodes=[],this.extensions=new Set}validate(){return this.nodes.length<1}}class GLTFNode{constructor(e){this.children=[],this.extensions=new Set,this.mesh=e.mesh,this.camera=e.camera,this.scale=e.scale,this.skin=e.skin,this.matrix=e.matrix,this.translation=e.translation,this.rotation=e.rotation,this.name=e.name,this.weights=e.weights}validateTransforms(){let e=!0;return void 0!==this.matrix&&(void 0===this.rotation&&void 0===this.scale&&void 0===this.translation||(e=!1)),16!==this.matrix.length&&(e=!1),3!==this.scale.length&&(e=!1),3!==this.translation.length&&(e=!1),e=4===this.rotation.length&&this.rotation.every(e=>1<e||e<-1),e}validate(){return!this.validateTransforms()&&(!(this.weights.length<1)&&((void 0===this.weights||void 0!==this.mesh)&&((void 0===this.skin||void 0!==this.mesh)&&!(this.children.length<1))))}}class GLTFMesh{constructor(){this.primitives=[],this.extensions=new Set}validate(){let e=!1;return this.primitives.every(e=>e.validate())&&(e=!0),e}}!function(e){e.OPAQUE="OPAQUE",e.MASK="MASK",e.BLEND="BLEND"}(GLTFAlphaMode=GLTFAlphaMode||{});var GLTFPrimitiveMode,GLTFAlphaMode$1=GLTFAlphaMode;class GLTFMaterial{constructor(){this.extensions=new Set}validate(){return!1!==this.pbrMetallicRoughness.validate()&&(!1!==this.normalTexture.validate()&&(!1!==this.occlusionTexture.validate()&&((this.alphaMode!==GLTFAlphaMode$1.MASK||void 0!==this.alphaCutoff)&&3===this.emissiveFactor.length)))}}class GLTFTexture{constructor(){this.extensions=new Set,this.validate=()=>!0}}class GLTFImage{constructor(){this.extensions=new Set}validate(){return(void 0===this.uri||void 0===this.bufferView)&&(void 0===this.bufferView||void 0!==this.mimeType)}}class GLTFSampler{constructor(){this.extensions=new Set,this.validate=()=>!0}}class GLTFAnimation{constructor(){this.extensions=new Set}validate(){return!(this.channels.length<1||this.samplers.length<1)}}class GLTFCamera{constructor(e){this.extensions=new Set,this.orthographic=e.orthographic,this.perspective=e.perspective,this.type=e.type,this.name=e.name}validate(){return void 0===this.orthographic||void 0===this.perspective}}class GLTFSkin{constructor(){this.extensions=new Set}validate(){return!(this.joints.length<1)}}!function(e){e[e.POINTS=0]="POINTS",e[e.LINES=1]="LINES",e[e.LINE_LOOP=2]="LINE_LOOP",e[e.LINE_STRIP=3]="LINE_STRIP",e[e.TRIANGLES=4]="TRIANGLES",e[e.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",e[e.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(GLTFPrimitiveMode=GLTFPrimitiveMode||{});var GLTFAttributeType,GLTFPrimitiveMode$1=GLTFPrimitiveMode;class GLTFPrimitiveAttribute{constructor(e){this.position=e.position,this.st1=e.st1,this.normal=e.normal}validate(){return Object.values(this).every(e=>e<0)}}class GLTFPrimitive{constructor(e){this.extensions=new Set,this.attribute=new GLTFPrimitiveAttribute({position:e.attribute.position,st1:e.attribute.st1,normal:e.attribute.normal}),this.indices=e.indices,this.material=e.material,e.mode!==GLTFPrimitiveMode$1.TRIANGLES&&(this.mode=e.mode)}validate(){return!1!==this.attribute.validate()&&(!(this.indices<0)&&!(this.material<0))}}class GLTFAnimationChannel{constructor(){this.extensions=new Set,this.validate=()=>this.target.validate()}}class GLTFAnimationChannelTarget{constructor(){this.extensions=new Set,this.validate=()=>!0}}class GLTFAnimationSampler{}class GLTFAccessorSparse{validate(){return this.values.validate()&&this.indices.validate()}}!function(e){e.SCALAR="SCALAR",e.VEC2="VEC2",e.VEC3="VEC3",e.VEC4="VEC4",e.MAT2="MAT2",e.MAT3="MAT3",e.MAT4="MAT4"}(GLTFAttributeType=GLTFAttributeType||{});var GLTFComponentType,GLTFAttributeType$1=GLTFAttributeType;!function(e){e[e.BYTE=5120]="BYTE",e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.SHORT=5122]="SHORT",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.FLOAT=5126]="FLOAT"}(GLTFComponentType=GLTFComponentType||{});var GLTFFilter,GLTFComponentType$1=GLTFComponentType;!function(e){e[e.NEAREST=9728]="NEAREST",e[e.LINEAR=9729]="LINEAR",e[e.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",e[e.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",e[e.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",e[e.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR"}(GLTFFilter=GLTFFilter||{});var GLTFWrapMode,GLTFFilter$1=GLTFFilter;!function(e){e[e.REPEAT=10497]="REPEAT",e[e.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(GLTFWrapMode=GLTFWrapMode||{});var MIME,GLTFWrapMode$1=GLTFWrapMode;!function(e){e.JPG="image/jpg",e.JPEG="image/jpeg",e.PNG="image/png",e.WEBP="image/webp"}(MIME=MIME||{});var MIME$1=MIME;class GLTFAccessorSparseIndices{constructor(){this.extensions=new Set}validate(){return this.componentType===GLTFComponentType$1.UNSIGNED_BYTE||this.componentType===GLTFComponentType$1.UNSIGNED_INT||this.componentType===GLTFComponentType$1.UNSIGNED_SHORT}}class GLTFAccessorSparseValues{constructor(){this.extensions=new Set}validate(){return!(this.byteOffset<0)}}class GLTFTextureInfo{constructor(e,t){this.index=e,this.texCoord=t}validate(){return this.index<0||this.texCoord<0}}class GLTFNormalTextureInfo extends GLTFTextureInfo{constructor(e,t,r){super(e,t),this.extensions=new Set,this.scale=r}}class GLTFOcclusionTextureInfo extends GLTFTextureInfo{constructor(e,t,r){super(e,t),this.extensions=new Set,this.strength=r}validate(){return 1<this.strength||this.strength<0}}class GLTFPbr{constructor(){this.extensions=new Set}validate(){return 4===this.baseColorFactor.length&&!this.baseColorFactor.every(e=>e<0||1<e)&&(!(1<this.roughnessFactor||this.roughnessFactor<0)&&(!(1<this.metallicFactor||this.metallicFactor<0)&&(!1!==this.baseColorTexture.validate()&&!1!==this.metallicRoughnessTexture.validate())))}}class GLTFPerspectiveCamera{constructor(e){this.yfov=e.yfov,this.znear=e.znear,this.zfar=e.zfar,this.aspectRatio=e.aspectRatio}validate(){return!1}}class GLTFOrthographicCamera{constructor(e){this.xmag=e.xmag,this.ymag=e.ymag,this.zfar=e.zfar,this.znear=e.znear}}class GLTFDocument{constructor(){this.asset=new GLTFAsset,this.scene=0,this.buffers=[],this.bufferViews=[],this.accessors=[],this.scenes=[],this.nodes=[],this.meshes=[],this.materials=[],this.textures=[],this.images=[],this.samplers=[]}}class GLTFExtensionBase{get isRequire(){return!1}validate(){return!0}}class ExtDraco extends GLTFExtensionBase{constructor(){super(...arguments),this.name="KHR_draco_mesh_compression"}get isRequire(){return!0}validate(){return Number.isInteger(this.bufferView)}}class ExtPbrSpecularGlossiness extends GLTFExtensionBase{constructor(){super(...arguments),this.name="KHR_materials_pbrSpecularGlossiness"}get isRequire(){return!0}validate(){return!0}}class GLTFWriteAction{constructor(){this.doc=void 0}setDocument(e){this.doc=e}write(e){return console.log(e),this.doc}}class GLTFReadAction{constructor(){}read(e){e()}}class TilesetExtBase{}class ExtBatchtableHierarchy extends TilesetExtBase{constructor(){super(...arguments),this.name="3DTILES_batch_table_hierarchy"}load(){}}class ExtPntsDraco extends TilesetExtBase{constructor(){super(...arguments),this.name="3DTILES_draco_point_compression"}}class ExtContentGLTF extends TilesetExtBase{constructor(){super(...arguments),this.name="3DTILES_content_gltf"}}class ExtImplicitTiling extends TilesetExtBase{constructor(){super(...arguments),this.name="3DTILES_implicit_tiling"}}class ExtLayers extends TilesetExtBase{constructor(){super(...arguments),this.name="3DTILES_layers"}}class ExtMetadata extends TilesetExtBase{constructor(){super(...arguments),this.name="3DTILES_metadata"}}class ExtMultipleContent extends TilesetExtBase{constructor(){super(...arguments),this.name="3DTILES_multiple_contents"}}class Tile{constructor(){this.transform=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this.extensions=new Set}validate(){return!0}toJson(){if(!this.validate())throw new Error("[Tile toJson()] 验证此对象失败！");void 0!==this.transform&&Object.defineProperty({},"transform",{value:this.transform})}}class Tileset{constructor(e){this.extensions=new Set,this.extensionsUsed=[],this.extensionsRequired=[],this.root=e.root,this.geometricError=e.geometricError,this.uri=e.uri}get url(){return this.uri}set url(e){this.uri=e}}class TileBoundingVolume{validate(){return(void 0===this.box?1:0)+(void 0===this.region?1:0)+(void 0===this.sphere?1:0)==2&&(12==this.box.length&&(6==this.region.length&&4==this.sphere.length))}}class TileContent{constructor(){this.extensions=new Set}get url(){return this.uri}validate(){return!0}}class Property{}class Asset{validate(){return!0}}class TileHeaderBase{validate(){return!0}}class B3dmHeader extends TileHeaderBase{constructor(){super()}}function unwrapExports(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function createCommonjsModule(e,t){return e(t={exports:{}},t.exports),t.exports}!function(e){function t(e="utf-8"){if("utf-8"!==e)throw new RangeError(`Failed to construct 'TextEncoder': The encoding label provided ('${e}') is invalid.`)}function r(e="utf-8",t={fatal:!1}){if("utf-8"!==e)throw new RangeError(`Failed to construct 'TextDecoder': The encoding label provided ('${e}') is invalid.`);if(t.fatal)throw new Error("Failed to construct 'TextDecoder': the 'fatal' option is unsupported.")}e.TextEncoder&&e.TextDecoder||(Object.defineProperty(t.prototype,"encoding",{value:"utf-8"}),t.prototype.encode=function(t,e={stream:!1}){if(e.stream)throw new Error("Failed to encode: the 'stream' option is unsupported.");let r=0;var s,i=t.length;let a=0,n=Math.max(32,i+(i>>1)+7),o=new Uint8Array(n>>3<<3);for(;r<i;){let e=t.charCodeAt(r++);if(55296<=e&&e<=56319)if(r<i&&(56320==(64512&(s=t.charCodeAt(r)))&&(++r,e=((1023&e)<<10)+(1023&s)+65536)),55296<=e&&e<=56319)continue;if(a+4>o.length){n+=8,n*=1+r/t.length*2,n=n>>3<<3;const h=new Uint8Array(n);h.set(o),o=h}if(0!=(4294967168&e)){if(0==(4294965248&e))o[a++]=e>>6&31|192;else if(0==(4294901760&e))o[a++]=e>>12&15|224,o[a++]=e>>6&63|128;else{if(0!=(4292870144&e))continue;o[a++]=e>>18&7|240,o[a++]=e>>12&63|128,o[a++]=e>>6&63|128}o[a++]=63&e|128}else o[a++]=e}return o.slice(0,a)},Object.defineProperty(r.prototype,"encoding",{value:"utf-8"}),Object.defineProperty(r.prototype,"fatal",{value:!1}),Object.defineProperty(r.prototype,"ignoreBOM",{value:!1}),r.prototype.decode=function(e,t={stream:!1}){if(t.stream)throw new Error("Failed to decode: the 'stream' option is unsupported.");var r=new Uint8Array(e);let s=0;var i=r.length;const a=[];for(;s<i;){var n=r[s++];if(0===n)break;if(0==(128&n))a.push(n);else if(192==(224&n)){var o=63&r[s++];a.push((31&n)<<6|o)}else if(224==(240&n)){var h=63&r[s++],o=63&r[s++];a.push((31&n)<<12|h<<6|o)}else if(240==(248&n)){let e=(7&n)<<18|(63&r[s++])<<12|(63&r[s++])<<6|63&r[s++];65535<e&&(e-=65536,a.push(e>>>10&1023|55296),e=56320|1023&e),a.push(e)}}return String.fromCharCode.apply(null,a)},e.TextEncoder=t,e.TextDecoder=r)}("undefined"!=typeof window?window:"undefined"!=typeof self?self:void 0);var utf8_browser=createCommonjsModule(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.encode=t.decode=void 0;const r=new TextDecoder("utf-8");t.decode=function(e){return r.decode(e)};const s=new TextEncoder;t.encode=function(e){return s.encode(e)}});unwrapExports(utf8_browser),utf8_browser.encode,utf8_browser.decode;var IOBuffer_1=createCommonjsModule(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.IOBuffer=void 0;t.IOBuffer=class a{constructor(e=8192,t={}){let r=!1;"number"==typeof e?e=new ArrayBuffer(e):(r=!0,this.lastWrittenByte=e.byteLength);var s=t.offset?t.offset>>>0:0,t=e.byteLength-s;let i=s;(ArrayBuffer.isView(e)||e instanceof a)&&(e.byteLength!==e.buffer.byteLength&&(i=e.byteOffset+s),e=e.buffer),r?this.lastWrittenByte=t:this.lastWrittenByte=0,this.buffer=e,this.length=t,this.byteLength=t,this.byteOffset=i,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,i,t),this._mark=0,this._marks=[]}available(e=1){return this.offset+e<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(e=1){return this.offset+=e,this}seek(e){return this.offset=e,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){var e=this._marks.pop();if(void 0===e)throw new Error("Mark stack empty");return this.seek(e),this}rewind(){return this.offset=0,this}ensureAvailable(e=1){if(!this.available(e)){e=2*(this.offset+e);const t=new Uint8Array(e);t.set(new Uint8Array(this.buffer)),this.buffer=t.buffer,this.length=this.byteLength=e,this._data=new DataView(this.buffer)}return this}readBoolean(){return 0!==this.readUint8()}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(t=1){const r=new Uint8Array(t);for(let e=0;e<t;e++)r[e]=this.readByte();return r}readInt16(){var e=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}readUint16(){var e=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,e}readInt32(){var e=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}readUint32(){var e=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat32(){var e=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat64(){var e=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}readChar(){return String.fromCharCode(this.readInt8())}readChars(t=1){let r="";for(let e=0;e<t;e++)r+=this.readChar();return r}readUtf8(e=1){return utf8_browser.decode(this.readBytes(e))}writeBoolean(e){return this.writeUint8(e?255:0),this}writeInt8(e){return this.ensureAvailable(1),this._data.setInt8(this.offset++,e),this._updateLastWrittenByte(),this}writeUint8(e){return this.ensureAvailable(1),this._data.setUint8(this.offset++,e),this._updateLastWrittenByte(),this}writeByte(e){return this.writeUint8(e)}writeBytes(t){this.ensureAvailable(t.length);for(let e=0;e<t.length;e++)this._data.setUint8(this.offset++,t[e]);return this._updateLastWrittenByte(),this}writeInt16(e){return this.ensureAvailable(2),this._data.setInt16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(e){return this.ensureAvailable(2),this._data.setUint16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(e){return this.ensureAvailable(4),this._data.setInt32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(e){return this.ensureAvailable(4),this._data.setUint32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(e){return this.ensureAvailable(4),this._data.setFloat32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(e){return this.ensureAvailable(8),this._data.setFloat64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(e){return this.writeUint8(e.charCodeAt(0))}writeChars(t){for(let e=0;e<t.length;e++)this.writeUint8(t.charCodeAt(e));return this}writeUtf8(e){return this.writeBytes(utf8_browser.encode(e))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}});unwrapExports(IOBuffer_1);var FeatureTableType,IOBuffer_2=IOBuffer_1.IOBuffer;!function(e){e.B3dm="b3dm",e.I3dm="i3dm",e.Pnts="pnts",e.Vctr="vctr"}(FeatureTableType=FeatureTableType||{});var TileRefine,FeatureTableType$1=FeatureTableType;class FeatureTable{validate(){return!1}}function validateB3dmBatchTable(e){return void 0!==e.batchLength}function parse$6(e){var t=e._json;e.batchLength=t.BATCH_LENGTH,e.rtcCenter=t.RTC_CENTER,void 0!==t.extensions&&(e.extensions=new Set),e.extras=t.extras}class B3dmFeatureTable extends FeatureTable{constructor(){super()}static createFromJSON(e,t){const r=new B3dmFeatureTable;return r._json=e,r._binary=t,r.featureTableType=FeatureTableType$1.B3dm,parse$6(r),r}validate(){return validateB3dmBatchTable(this)}}function parse$5(e){for(const t of Object.keys(e._json))e.variables.set(t,e._json[t])}class BatchTable{constructor(){this.variables=new Map}static createFromJSON(e,t){const r=new BatchTable;return r._json=e,r._binary=t,parse$5(r),r}validate(){return!0}get variableNames(){return Object.keys(this._json)}get variableCounts(){return this.variableNames.length}getVariable(e){if(this.variables.has(e))return this.variables.get(e);throw new Error(`[BatchTable getVariable()] 没有这个值：${e}。`)}}function parseHeader$2(e,t){t.rewind(),e.magic=t.readChars(4),e.version=t.readUint32(),e.byteLength=t.readUint32(),e.featureTableJSONByteLength=t.readUint32(),e.featureTableBinaryByteLength=t.readUint32(),e.batchTableJSONByteLength=t.readUint32(),e.batchTableBinaryByteLength=t.readUint32()}function parse$4(e,t){const r=new IOBuffer_2(t);if(parseHeader$2(e.header,r),e.byteLength%8!=0)throw new Error("[B3dm 实例化错误] byteLength 未 8 字节对齐。");r.rewind(),r.skip(28);var s=JSON.parse(r.readChars(e.featureTableJSONByteLength)),t=r.readBytes(e.featureTableBinaryByteLength);e.featureTable=B3dmFeatureTable.createFromJSON(s,t),0!==e.batchTableJSONByteLength&&(s=JSON.parse(r.readChars(e.batchTableJSONByteLength)),t=r.readBytes(e.batchTableBinaryByteLength),e.batchTable=BatchTable.createFromJSON(s,t))}class B3dm{constructor(e,t=!1){this.header=new B3dmHeader,parse$4(this,e),!0===t&&(this.buffer=e)}validate(){return!0}get magic(){return this.header.magic}get byteLength(){return this.header.byteLength}get version(){return this.header.version}get featureTableJSONByteLength(){return this.header.featureTableJSONByteLength}get featureTableBinaryByteLength(){return this.header.featureTableBinaryByteLength}get batchTableJSONByteLength(){return this.header.batchTableJSONByteLength}get batchTableBinaryByteLength(){return this.header.batchTableBinaryByteLength}get sizeWithoutGLB(){return 28+this.featureTableJSONByteLength+this.featureTableBinaryByteLength+this.batchTableJSONByteLength+this.batchTableBinaryByteLength}}class I3dmHeader extends TileHeaderBase{constructor(){super()}validate(){return 0===this.gltfFormat||1===this.gltfFormat}}function validateI3dmBatchTable(e){return(void 0!==e.position||void 0!==e.positionQuantized)&&((void 0===e.position||void 0===e.positionQuantized)&&((void 0===e.positionQuantized||void 0!==e.quantizedVolumeOffset&&void 0!==e.quantizedVolumeScale)&&(!(void 0===e.normalUp&&void 0!==e.normalRight||void 0===e.normalRight&&void 0!==e.normalUp)&&!(void 0===e.normalUpOct32p&&void 0!==e.normalRightOct32p||void 0===e.normalRightOct32p&&void 0!==e.normalUpOct32p))))}function parse$3(e){var t=e._json;e.position=t.POSITION,e.positionQuantized=t.POSITION_QUANTIZED,e.normalUp=t.NORMAL_UP,e.normalRight=t.NORMAL_RIGHT,e.normalUpOct32p=t.NORMAL_UP_OCT32P,e.normalRightOct32p=t.NORMAL_RIGHT_OCT32P,e.scale=t.SCALE,e.scaleNonUniform=t.SCALE_NON_UNIFORM,e.instancesLength=t.INSTANCES_LENGTH,e.rtcCenter=t.RTC_CENTER,e.quantizedVolumeOffset=t.QUANTIZED_VOLUME_OFFSET,e.quantizedVolumeScale=t.QUANTIZED_VOLUME_SCALE,void 0!==t.extensions&&(e.extensions=new Set),e.extras=t.extras}class I3dmFeatureTable extends FeatureTable{constructor(){super()}static createFromJSON(e,t){const r=new I3dmFeatureTable;return r._json=e,r._binary=t,r.featureTableType=FeatureTableType$1.I3dm,parse$3(r),r}validate(){return validateI3dmBatchTable(this)}}function parseHeader$1(e,t){t.rewind(),e.magic=t.readChars(4),e.version=t.readUint32(),e.byteLength=t.readUint32(),e.featureTableJSONByteLength=t.readUint32(),e.featureTableBinaryByteLength=t.readUint32(),e.batchTableJSONByteLength=t.readUint32(),e.batchTableBinaryByteLength=t.readUint32(),e.gltfFormat=t.readUint32()}function parse$2(e,t){const r=new IOBuffer_2(t);if(parseHeader$1(e.header,r),e.byteLength%8!=0)throw new Error("[I3dm 实例化错误] byteLength 未 8 字节对齐。");r.rewind(),r.skip(32);var s=JSON.parse(r.readChars(e.featureTableJSONByteLength)),t=r.readBytes(e.featureTableBinaryByteLength);e.featureTable=I3dmFeatureTable.createFromJSON(s,t),0!==e.batchTableJSONByteLength&&(s=JSON.parse(r.readChars(e.batchTableJSONByteLength)),t=r.readBytes(e.batchTableBinaryByteLength),e.batchTable=BatchTable.createFromJSON(s,t))}class I3dm{constructor(e,t=!1){this.header=new I3dmHeader,parse$2(this,e),!0===t&&(this.buffer=e)}validate(){return!0}get magic(){return this.header.magic}get byteLength(){return this.header.byteLength}get version(){return this.header.version}get featureTableJSONByteLength(){return this.header.featureTableJSONByteLength}get featureTableBinaryByteLength(){return this.header.featureTableBinaryByteLength}get batchTableJSONByteLength(){return this.header.batchTableJSONByteLength}get batchTableBinaryByteLength(){return this.header.batchTableBinaryByteLength}get gltfFormat(){return this.header.gltfFormat}get sizeWithoutExternalData(){return 32+this.featureTableJSONByteLength+this.featureTableBinaryByteLength+this.batchTableJSONByteLength+this.batchTableBinaryByteLength}}class PntsHeader extends TileHeaderBase{constructor(){super()}}function validatePntsFeatureTable(e){return(void 0!==e.position||void 0!==e.positionQuantized)&&((void 0===e.batchId||void 0!==e.batchLength)&&(void 0===e.positionQuantized||void 0!==e.quantizedVolumeOffset&&void 0!==e.quantizedVolumeScale))}function parse$1(e){var t=e._json;e.position=t.POSITION,e.positionQuantized=t.POSITION_QUANTIZED,e.rgba=t.RGBA,e.rgb=t.RGB,e.rgb565=t.RGB565,e.normal=t.NORMAL,e.normalOct16p=t.NORMAL_OCT16P,e.batchId=t.BATCH_ID,e.pointsLength=t.POINTS_LENGTH,e.quantizedVolumeOffset=t.QUANTIZED_VOLUME_OFFSET,e.quantizedVolumeScale=t.QUANTIZED_VOLUME_SCALE,e.constantRgba=t.CONSTANT_RGBA,void 0!==t.extensions&&(e.extensions=new Set),e.extras=t.extras}class PntsFeatureTable extends FeatureTable{constructor(){super()}static createFromJSON(e,t){const r=new PntsFeatureTable;return r._json=e,r._binary=t,r.featureTableType=FeatureTableType$1.Pnts,parse$1(r),r}validate(){return validatePntsFeatureTable(this)}}function parseHeader(e,t){t.rewind(),e.magic=t.readChars(4),e.version=t.readUint32(),e.byteLength=t.readUint32(),e.featureTableJSONByteLength=t.readUint32(),e.featureTableBinaryByteLength=t.readUint32(),e.batchTableJSONByteLength=t.readUint32(),e.batchTableBinaryByteLength=t.readUint32()}function parse(e,t){const r=new IOBuffer_2(t);if(parseHeader(e.header,r),e.byteLength%8!=0)throw new Error("[Pnts 实例化错误] byteLength 未 8 字节对齐。");r.rewind(),r.skip(28);var s=JSON.parse(r.readChars(e.featureTableJSONByteLength)),t=r.readBytes(e.featureTableBinaryByteLength);e.featureTable=PntsFeatureTable.createFromJSON(s,t),0!==e.batchTableJSONByteLength&&(s=JSON.parse(r.readChars(e.batchTableJSONByteLength)),t=r.readBytes(e.batchTableBinaryByteLength),e.batchTable=BatchTable.createFromJSON(s,t))}class Pnts{constructor(e,t=!1){this.header=new PntsHeader,parse(this,e),!0===t&&(this.buffer=e)}validate(){return!0}get magic(){return this.header.magic}get byteLength(){return this.header.byteLength}get version(){return this.header.version}get featureTableJSONByteLength(){return this.header.featureTableJSONByteLength}get featureTableBinaryByteLength(){return this.header.featureTableBinaryByteLength}get batchTableJSONByteLength(){return this.header.batchTableJSONByteLength}get batchTableBinaryByteLength(){return this.header.batchTableBinaryByteLength}get sizeWithoutGLB(){return 28+this.featureTableJSONByteLength+this.featureTableBinaryByteLength+this.batchTableJSONByteLength+this.batchTableBinaryByteLength}}class Cmpt{}!function(e){e.ADD="add",e.REPLACE="replace"}(TileRefine=TileRefine||{});var TileRefine$1=TileRefine;exports.Asset=Asset,exports.B3dm=B3dm,exports.B3dmHeader=B3dmHeader,exports.BatchTable=BatchTable,exports.Cmpt=Cmpt,exports.ExtBatchtableHierarchy=ExtBatchtableHierarchy,exports.ExtContentGLTF=ExtContentGLTF,exports.ExtDraco=ExtDraco,exports.ExtImplicitTiling=ExtImplicitTiling,exports.ExtLayers=ExtLayers,exports.ExtMetadata=ExtMetadata,exports.ExtMultipleContent=ExtMultipleContent,exports.ExtPbrSpecularGlossiness=ExtPbrSpecularGlossiness,exports.ExtPntsDraco=ExtPntsDraco,exports.FeatureTable=FeatureTable,exports.GLTFAccessor=GLTFAccessor,exports.GLTFAccessorSparse=GLTFAccessorSparse,exports.GLTFAccessorSparseIndices=GLTFAccessorSparseIndices,exports.GLTFAccessorSparseValues=GLTFAccessorSparseValues,exports.GLTFAlphaMode=GLTFAlphaMode$1,exports.GLTFAnimation=GLTFAnimation,exports.GLTFAnimationChannel=GLTFAnimationChannel,exports.GLTFAnimationChannelTarget=GLTFAnimationChannelTarget,exports.GLTFAnimationSampler=GLTFAnimationSampler,exports.GLTFAsset=GLTFAsset,exports.GLTFAttributeType=GLTFAttributeType$1,exports.GLTFBuffer=GLTFBuffer,exports.GLTFBufferView=GLTFBufferView,exports.GLTFCamera=GLTFCamera,exports.GLTFComponentType=GLTFComponentType$1,exports.GLTFDocument=GLTFDocument,exports.GLTFExtensionBase=GLTFExtensionBase,exports.GLTFFilter=GLTFFilter$1,exports.GLTFImage=GLTFImage,exports.GLTFMaterial=GLTFMaterial,exports.GLTFMesh=GLTFMesh,exports.GLTFNode=GLTFNode,exports.GLTFNormalTextureInfo=GLTFNormalTextureInfo,exports.GLTFOcclusionTextureInfo=GLTFOcclusionTextureInfo,exports.GLTFOrthographicCamera=GLTFOrthographicCamera,exports.GLTFPbr=GLTFPbr,exports.GLTFPerspectiveCamera=GLTFPerspectiveCamera,exports.GLTFPrimitive=GLTFPrimitive,exports.GLTFPrimitiveAttribute=GLTFPrimitiveAttribute,exports.GLTFPrimitiveMode=GLTFPrimitiveMode$1,exports.GLTFReadAction=GLTFReadAction,exports.GLTFSampler=GLTFSampler,exports.GLTFScene=GLTFScene,exports.GLTFSkin=GLTFSkin,exports.GLTFTexture=GLTFTexture,exports.GLTFTextureInfo=GLTFTextureInfo,exports.GLTFVersion=GLTFVersion$1,exports.GLTFWrapMode=GLTFWrapMode$1,exports.GLTFWriteAction=GLTFWriteAction,exports.I3dm=I3dm,exports.I3dmHeader=I3dmHeader,exports.MIME=MIME$1,exports.Pnts=Pnts,exports.PntsHeader=PntsHeader,exports.Property=Property,exports.Tile=Tile,exports.TileBoundingVolume=TileBoundingVolume,exports.TileContent=TileContent,exports.TileHeaderBase=TileHeaderBase,exports.TileRefine=TileRefine$1,exports.Tileset=Tileset;
//# sourceMappingURL=ts-3dtiles.cjs.js.map
